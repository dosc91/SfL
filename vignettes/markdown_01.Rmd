---
title: "Introduction to R and RStudio"
author: "Dominic Schmitz"
date: "Workshop: Statistics for Linguistics | Session 1"
output:
  rmdformats::readthedown:
    self_contained: true
    thumbnails: false
    lightbox: true
---

<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

<style type="text/css">

body {
    background: #ffffff;
}

#content{
    max-width: 1400px;
    background: #ffffff;
}

#main a{
    color: #48769e;
    background-image: none;
    font-family: "Roboto", sans-serif;
}

#main a:hover{
    color: #679ae2;
    background: transparent;
    text-decoration: underline;
    background-image: linear-gradient(180deg,#ffffff,#ffffff)
}

h1,h2,h3,h4,h5,h6,legend{
    color: #404248;
    font-family: "Roboto", sans-serif;
}

#nav-top span.glyphicon {
  color: blue;
}

#table-of-contents header{
    color: white;
}

#table-of-contents h2{
    background-color: white;
}

#table-of-contents ul.nav li.active a {
  color: #404248;
}

#table-of-contents ul.nav li.active ul li a {
  background-color: #f1f8fe;
}

#table-of-contents ul.nav li.active ul li.active a {
  background-color: #6ec1e4;
}

a:hover{
    color: white
}

a:visited{
    color: white
}

#sidebar{
    background: #48769e
}

#sidebar h2{
    background: #32485b
}

#sidebar a{
    color: white
}

#sidebar a:hover{
    background: #32485b
}

#postamble{
    background: #32485b;
    border-top: solid 5px #32485b;
    text-align: center
}

#postamble a:hover{
    background: #48769e;
}

#postamble .date{
    color: white;
    text-align: center
}

#content ul, #content ul li{
    font-size: 14px
}

#content ul li{
    font-size: 14px
}

.math {
  font-size: 14px
}

.math inline {
  font-size: 14px
}

.math .inline {
  font-size: 14px
}

.divider
{
	position: relative;
	margin-top: 50px;
	margin-bottom: 50px;
	height: 1px;
}

.div-transparent:before
{
	content: "";
	position: absolute;
	top: 0;
	left: 5%;
	right: 5%;
	width: 90%;
	height: 1px;
	background-image: linear-gradient(to right, transparent, rgb(48,49,51), transparent);
}

.mydisclaimer p em{
    font-size: 12px;
}

table{
  width: 100%;
}

summary{
  font-size:16px;
}

.solution{
  color: #48769e;
  cursor: pointer;
}

.solution:before{
  content: '\25B6';
}

.aufgaben {
  border: 1px dashed #6ec1e4;
  border-radius: 5px;
  padding: 6px;
}

code{
  color: #9a38c0;
}

</style>

```{r knitr_init, echo=FALSE, results="asis", cache=FALSE, warning=FALSE, message=FALSE}
library(knitr)
library(rmdformats)
library(DT)
## Global options
options(max.print = "75")
opts_chunk$set(echo = TRUE,
	             cache = FALSE,
               prompt = FALSE,
               tidy = FALSE,
               comment = NA,
               message = FALSE,
               warning = FALSE)
opts_knit$set(width = 75)
```

```{r include=FALSE, warning=FALSE, message=FALSE}
library(kableExtra)
library(ggplot2)
library(png)
library(ggpubr)
```

---

<div class="logo">

  <img src="figures/sfl_logo.png" style="float:right">

</div>


This document introduces the main functions of R in RStudio.

An overview of the following topics is given:

- Scripts
- Variables
- Vectors
- Functions
- Data Frames
- Packages
- Miscellaneous stuff

All code given in this introduction can be used/redone by you in your own locally installed R in RStudio. Following and testing all code is highly recommended to become familiar with R and RStudio.

Fun Fact: This document is created in R/RStudio using so called *R Markdown*. Using *R Markdown*, all sorts of files can be created from within RStudio, e.g. html files, powerpoint files, pdf files, word files.

<div class="divider div-transparent"></div>

# 01 R Scripts

The term *scripts* may sound terribly technical at first. However, do not despair! In R, *scripts* are nothing more but text files in which your code, i.e. whatever you do in R, is saved. *R scripts* are saved with the file extension 'R' and can be opened with RStudio and most text editors (e.g. Notepad++).

It is highly advised to use scripts when working with R at all times! Everything not saved in scripts is usually lost once the R/RStudio session is closed. For example, anything you type in the *console* window is gone once too many lines within the window are reached. Additionally, scripts help you maintain a clear and comprehensible structure of your work in R.

To create a new script in RStudio, mouse-click on the symbol of a blank sheet of paper with a green plus in the top left of the window. Alternatively, go to `File` > `New File` > `R Script`. Save your scripts regularly when working on them.

To help maintaining the comprehensibility of your script, you can use comments and sections. This may sound unnecessary at first, especially for short scripts, but truth be told: You will most likely not know what is happening in your script when revisiting it after some months.

---

Thus, **commenting** is usually helpful. Any line starting with `#` in an R script is a comment, i.e. it is not run as code. For example:

```{r include=T, eval=F}
# Hi! I am a comment.

# The following line is executed as code:
1+1

# The following line is not executed as code:
# 1+1
```

---

Once your scripts span hundreds of lines, it is advised to use **sections**. Sections have several layers. For example:

```{r include=T, eval=F}
#### Section 1: Data ----

##### Section 1.1: Variables -----

###### Section 1.1.1: Speaking Rate ------
```

Sections can be selected using either the dropdown menu at the bottom of the script window (see image below) or by using the document outline view (`ctrl` + `shift` + `O`).

```{r fig.align='center', echo=FALSE}
img1_path <- "figures/sections.png"
img1 <- readPNG(img1_path, native = TRUE, info = TRUE)

# All defaults
include_graphics(img1_path)
```

---

To **execute** code in your script, mouse-click somewhere at the line you wish to execute. It does not matter whether your cursor is at the beginning, middle, or end of the code line. Then, press `crtl` + `enter`. In the following code, some exemplary cursor positions are indicated by a `|` symbol. 

```{r include=T, eval=F}
|1 + 12|00 / 48 * 48 - 33^8|
```

---

Finally, a symbol combination often used in R scripts is `<-`. You can either type this combination of symbols with your keyboard or press `alt` + `-` (Windows) and `option` + `-` (Mac).

<div class="divider div-transparent"></div>

# 02 General Introduction

We start with a few simple examples. R can be used as an oversized calculator:

```{r include=T, eval=F}
125+179

65593.00035-6593.33657 

1769.357*753.001 

9852/0.000025

3*866585.3==2599756

25^4 > 20^5 

2e-5 < 0.00003 

3^2!=9
```

Easy, right?

<div class="divider div-transparent"></div>

# 03 Variables

Working with R, you will define variables on the fly. Variables are names given to values and other, more complex objects. Variable names can be chosen with only a few restrictions: They must not start with an underscore `_`, with a period `.`, or with a number `1`.

<div class="aufgaben">

## Exercises

Decide: Which of the following variable names are legal?

- weight1
- 2c_length 
- data.new 
- _new.data.1b 
- 1b.da 
- ta.experiment
- new_data_6
- last_trial.c 
- data.as.formated.by.jack.the.other.day 
- d1

<details>
  <summary class="solution">Solutions</summary>
  
- weight1 OKAY
- 2c_length NOT OKAY
- data.new OKAY
- _new.data.1b NOT OKAY
- 1b.da NOT OKAY
- ta.experiment OKAY
- new_data_6 OKAY
- last_trial.c OKAY
- data.as.formated.by.jack.the.other.day OKAY 
- d1 OKAY
  
</details>
</div>
</br>

---

Variable names are overwritten if used more than once. Thus, defining a variable called `varA` with a value of $5$, and then defining a variable with the same name with a value of $33$, results in `varA` with a value of $33$:

```{r include=T, eval=T}
varA <- 5

varA <- 33

varA
```

You should always keep track of which variable names you have used already. The *environment* panel in the upper right part of RStudio usually helps with this, as all defined variables are listed here.

---
Variables can be used to calculate all sorts of stuff. For example:

```{r include=T, eval=T}
variable1 <- 10
```

The variable `variable1` is now defined with a value of $10$. We can use this variable for calculations:

```{r include=T, eval=T}
variable1 + 9

variable1 - 3

variable1 * variable1 

100 / variable1 
```

<div class="aufgaben">

## Exercises

Can you tell the result of the individual lines of code without running them?

```{r include=T, eval=F}
var.a <- 6*30
var.b <- 9

var.a + var.b
```

Check whether your predictions are correct!

</div>

<div class="divider div-transparent"></div>


# 04 Vectors

*Vectors* may sound like terrible maths or physics, but no worries - their concept is quite simple. In R, vectors are collections of values. The individual values of a vector are called elements of that vector.

In R, vectors are created by a huge number of different functions. The easiest of these function is `c()` - *c* as in *concatenate*. For example:

```{r include=T, eval=T}
vector1 <- c(10, 20, 30, 40, 50)
```

Calling this vector (i.e. simply typing its name and executing that line) results in the printing of its values:

```{r include=T, eval=T}
vector1
```

Vectors can be used to do calculations as well. What do you think is the results of the following code?

```{r include=T, eval=F}
vector1 + 1
```

---

An important feature of vectors are their length:

```{r include=T, eval=T}
length(vector1)
```

<div class="divider div-transparent"></div>

## Types of Vectors

There are several different types of vectors in R:

- **character**; "a", "white"
- **integer**; 2L, 453k, 47
- **numerical**: 25.1, 0.0002
- **logical**; TRUE, FALSE
- **complex**; 1+4i

Vectors containing words are often called *factors*.

```{r include=T, eval=T}
vector2 <- c("bacon", "eggs", "sausage", "beans", "spam")

vector2
```

<div class="divider div-transparent"></div>

## Sequences

Sequences are represented with a colon in R:

```{r include=T, eval=T}
1:5
```

Sequences can be used for all sorts of things, for example when defining a vector:

```{r include=T, eval=T}
vector3 <- 1:5

vector3
```

Also, sequences can be used to print particular parts of vectors:

```{r include=T, eval=T}
vector2[2:4]
```

<div class="aufgaben">

## Exercises

1 Create a factor containing six colour names.

<details>
  <summary class="solution">Solution</summary>
  
```{r include=T, eval=F}
colours <- c("red", "blue", "green", "yellow", "pink", "black")
```
  
</details></br>

2 Use a colon to print the third, fourth, and fifth colour name at once.

<details>
  <summary class="solution">Solution</summary>
  
```{r include=T, eval=F}
colours[3:5]
```
  
</details></br>

3 Create a vector with the values $3$, $6$ and $9$.

<details>
  <summary class="solution">Solution</summary>
  
```{r include=T, eval=T}
numbers <- c(3, 6, 9)
```
  
</details></br>

</div>

<div class="divider div-transparent"></div>

# 05 Functions

So far, we mainly used R as an oversized calculator for simple calculations. However, what makes R a handy tool in research is the huge number of functions to use. Functions do most work for us: they calculate, manipulate, change, write, read, plot, etc.

We have already met two functions: `c()` and `length()`.

R itself already comes with a great number of functions. However, we regularly need functions beyond the standard functionality of R. In such cases, readily available and always free of cost packages can be used. We will take a closer look at packages later on [here](#packages).

Some functions which are regularly used are `sum()` and `rep()`.

```{r include=T, eval=T}
sum(vector1)
```

```{r include=T, eval=T}
rep("a", 6)
```

Functions can be combined as along as you keep track of the right amount of brackets.

```{r include=T, eval=T}
rep(c(5, 15, 25), 3)
```

<div class="aufgaben">

## Exercises

</details>

1 Create a vector in which the vector created in the last exercise of section 04 is repeated 5 times.

<details>
  <summary class="solution">Lösung</summary>
  
```{r include=T, eval=T}
numbers_repeated <- rep(numbers, 5)
```
  
</details></br>

2 Calculate the sum of the vector created in the previous exercise.

<details>
  <summary class="solution">Lösung</summary>
  
```{r include=T, eval=T}
sum(numbers_repeated)
```
  
</details>

</div>

<div class="divider div-transparent"></div>

# 06 Data Frames

In most cases, research data is not typed into R by hand but imported as tables. R can read different types of table formats, however, it is advised to use csv-file. Other table formats, for example xlsx-files, can be saved as csv-files using Excel, Calc and similar software.

In what follows, we will use an example csv-file for illustration purposes. This csv-file contains the names of pupils in one column, and their exam grades in further columns with one column per exam.

```{r include=F, eval=T}
notenspiegel <- read.csv("data/grades.csv", stringsAsFactors = TRUE)

names(notenspiegel)[names(notenspiegel) == "ï..Name"] <- "Name"
```

```{r echo=FALSE}
notenspiegel %>%
  kable() %>%
  kable_styling(position = "center", bootstrap_options = c("striped", "hover", "condensed", "responsive"), full_width = F)
```

---

However, before importing files is possible, R needs to be told where to search for files. </br>
**Your turn**: Create a dedicated folder on your machine called 'R_workshop'. Create this folder in a directory you easily find and remember, and for which you know its path.

Using its path and the folder name, we can tell R where to look for files. Anything you save using R will per default be saved in this folder. Please note that specifying this path is required after each restart of R/RStudio. Different projects should not only be done in different scripts but also within different folders on your machine.

```{r include=T, eval=F}
setwd("C:/.../.../.../.../R_Workshop")
```

**Note**: Depending on your OS, you either need to use `/` or `\`. `/` is usually used on Windows machines. In case neither works for whatever reason, there is another way to specify the working directory. In RStudio, click on `Session` at the top of the window. Then, follow `Set Working Directory` > `Choose Directory`, and navigate to the pertinent folder.

---

Now all we need is a csv-file to import. Please find the download <span style="color:red">**DOWNLOAD**</span>. Download this file to the previously created 'R_workshop' folder.

Finally, we can import this file into R:

```{r include=T, eval=F}
data.s <- read.csv("s_data_workshop.csv", stringsAsFactors=TRUE)
```

```{r include=F, eval=T}
data.s <- read.csv("data/s_data_workshop.csv", stringsAsFactors=TRUE)
```

When imported successfully, the object 'data.s' appears in the environment pane in the top right.

<div class="divider div-transparent"></div>

## Taking a closer look at data frames

Using the `str()` function one can get a first overview of any data frame object.

```{r include=T, eval=T}
str(data.s)
```

You will find that different variables have different vector types within the data frame.

<div class="aufgaben">

## Exercises

Take a closer look at all variable names of our data frame. Think about what variable might code what kind of information. Is there any variable for which you have no idea concerning its meaning? How do the different vector types help your considerations?

</div>

---

For each variable in the data frame the `summary()` function can be used to get a few summary statistics:

```{r include=T, eval=T}
summary(data.s)
```

Note that, depending on vector types, the output looks differently.

<div class="divider div-transparent"></div>

## Working with data frames

As you have probably already noticed, data frames consist of a number of vectors. But how can we refer to a single vector of a data frame?

This is done using the dollar symbol `$`:

```{r include=T, eval=T}
summary(data.s$sDur)
```

As you can see, only the summary statistics of the vector `sDur` is printed.

---

Sometimes you wish to create smaller data frames based in subgroups of your entire data frame. This can easily be done using the `subset` function.

```{r include=T, eval=T}
data.pl <- subset(data.s, typeOfS == "pl")
```

This creates a new data frame called `data.pl`. This data frame only contains those rows of `data.s` in which `typeOfS` is `pl`. The following code creates a third data frame for data on *is*-clitics:

```{r include=T, eval=T}
data.is <- subset(data.s, typeOfS == "is")
```

---

We can also combine different data frames into one bigger data frame:

```{r include=T, eval=T}
data.pl.is <- rbind(data.pl, data.is)
```


<div class="aufgaben">

## Exercises

1 Find the length of `speaker` and `item`.

<details>
  <summary class="solution">Lösung</summary>
  
```{r include=T, eval=F}
length(data.s$speaker)

length(data.s$item)
```
  
</details></br>

2 Create a new data frame in which only data with `typeOfS == "nm"` is contained.


<details>
  <summary class="solution">Lösung</summary>
  
```{r include=T, eval=F}
data.nm <- subset(data.s, typeOfS == "nm")
```

</details></br>

</div>

<div class="divider div-transparent"></div>

# 07 Packages

Packages are used to extend the functions of R. Packages are always free of charge - never trust a packages you must pay for!

One easy way to install a package is using code:

```{r include=T, eval=F}
install.packages("beepr")
```

In RStudio, packages can also be installed using the *packages* pane in the bottom right. Click on `Install` and input the name of the package you want to install in the middle text field. Clicking the `Install` button will install the pertinent package.

To use an installed package, the package must be loaded. This is done via code:

```{r include=T, eval=F}
library("beepr")
```

Similar to setting the working directory, this must be done in each new R session.

Now, you can use the `beep()` function:

```{r include=T, eval=F}
beep()
```

<div class="divider div-transparent"></div>

# 08 Miscellaneous

Done with sections 01 to 07 but still eager to learn more? You have come to the right section for that, buckle up!

## Random Numbers

Sometimes you wish to create a vector of random numbers, e.g. when needing some random values to try something out. This is where the `runif()` function comes in handy:

```{r include=T, eval=T}
random1 <- runif(5)

random1
```

You can also create random values which follow a normal distribution:

```{r include=T, eval=T}
random2 <- rnorm(500)

hist(random2)
```

<div class="divider div-transparent"></div>

## Rounding Up and Down

You can round values using the `round()` function:

```{r include=T, eval=T}
random1 <- runif(5)

random1

round(random1)

round(random1, 2)

round(random1, 4)
```

<div class="divider div-transparent"></div>

## Save Files

Having created some useful data frames, you sometimes wish the save them as files:

```{r include=T, eval=T}
data.pl <- subset(data.s, typeOfS == "pl") # this data frame was created earlier

write.csv(data.pl, "only_plural_s_data.csv")
```

<div class="divider div-transparent"></div>

## Sorting

R can automatically sort vector values.

```{r include=T, eval=T}
random1 <- runif(5)

random1
```

As you can see, the values of `random1` are not sorted. We want to change that:

```{r include=T, eval=T}
random1.sorted <- sort(random1)

random1.sorted
```

We can change the sorting, i.e. changing it from high to low values:

```{r include=T, eval=T}
random1.sorted2 <- sort(random1.sorted, decreasing = TRUE)

random1.sorted2
```

<div class="divider div-transparent"></div>

## Changing Vector Types

Sometimes you wish to change the type of a particular vector.

Let's start with a numeric vector:

```{r include=T, eval=T}
vektor.n <- c(10:15)

vektor.n
```

This vector can then be changed to a character vector or factor:

```{r include=T, eval=T}
vektor.n.character <- as.character(vektor.n)

vektor.n.character
```

```{r include=T, eval=T}
vektor.n.factor <- as.factor(vektor.n)

vektor.n.factor
```

<div class="divider div-transparent"></div>

## Factors: Changing levels, renaming and re-sorting

### Changing levels

This is one way (of many way) to change a level's name:

```{r include=T, eval=T}
vector2 <- as.factor(c("bacon", "eggs", "sausage", "beans", "spam"))

levels(vector2)
```

We want to change `sausage` to `toast`:

```{r include=T, eval=T}
levels(vector2)[levels(vector2)=="sausage"] <- "toast"

levels(vector2)
```

---

### Re-sorting

Sometimes you wish to change the order of levels of a factor. This can be done as follows:

```{r include=T, eval=T}
vector2 <- as.factor(c("bacon", "eggs", "sausage", "beans", "spam"))

vector2
```

```{r include=T, eval=T}
vector2.re_sorted <- factor(vector2, levels = c("spam", "sausage", "eggs", "beans", "bacon"))

vector2.re_sorted
```

<div class="divider div-transparent"></div>

## Data Frames: Renaming, removing, adding columns

We make use of the data frame imported in [section 06](#data-frames).

```{r include=T, eval=F}
data.s <- read.csv("s_data_workshop.csv")
```

### Renaming columns

We want to rename `item` to `word`:

```{r include=T, eval=T}
str(data.s[1:3])
```

```{r include=T, eval=T}
names(data.s)[names(data.s)=="item"] <- "word"

str(data.s[1:3])
```

---

### Removing columns

We want to remove the `list` column:

```{r include=T, eval=T}
str(data.s[5:8])
```

```{r include=T, eval=T}
data.s$list <- NULL

str(data.s[5:8])
```

---

### Adding columns

We want to add a column to the data frame:

```{r include=T, eval=T}
new.column <- runif(150)
```

```{r include=T, eval=T}
data.s$new.column <- new.column

head(data.s$new.column)
```

<div class="divider div-transparent"></div>

## Cookbook for R

Still hungry for more? The 'Cookbook for R' offers an overview of R basics. Click [here](http://www.cookbook-r.com/) and take a look at chapters 1 to 6.

<div class="divider div-transparent"></div>












